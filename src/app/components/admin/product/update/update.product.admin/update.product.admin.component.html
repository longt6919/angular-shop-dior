<div *ngIf="product">
  <div class="container my-3">
    <div class="row justify-content-center">
      <div class="col-md-10 col-lg-8">
        <div class="card border-0 shadow-sm rounded-3">
          <div class="card-header bg-light d-flex align-items-center gap-2">
            <i class="fa-solid fa-box-open text-primary"></i>
            <h3 class="card-title h6 m-0 fw-semibold">Cập nhật thông tin sản phẩm</h3>
          </div>

          <div class="card-body">
            <!-- Form cập nhật thông tin sản phẩm -->
            <form (ngSubmit)="updateProduct()">
              <!-- Tên -->
              <div class="form-group mb-3">
                <label for="name" class="form-label">Tên</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fa-solid fa-tag"></i></span>
                  <input
                    type="text"
                    id="name"
                    [(ngModel)]="updatedProduct.name"
                    name="name"
                    class="form-control"
                    required
                    placeholder="Nhập tên sản phẩm"
                  />
                </div>
              </div>

              <!-- Giá -->
              <div class="form-group mb-3">
                <label for="price" class="form-label">Giá</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fa-solid fa-money-bill-1-wave"></i></span>
                  <input
                    type="text"
                    id="price"
                    [(ngModel)]="updatedProduct.price"
                    name="price"
                    class="form-control"
                    required
                    placeholder="Ví dụ: 1.250.000"
                  />
                  <span class="input-group-text">đ</span>
                </div>
              </div>

              <!-- Mô tả -->
              <div class="form-group mb-3">
                <label for="description" class="form-label">Mô tả</label>
                <textarea
                  id="description"
                  [(ngModel)]="updatedProduct.description"
                  name="description"
                  class="form-control"
                  rows="3"
                  required
                  placeholder="Mô tả ngắn gọn về sản phẩm"
                ></textarea>
              </div>

              <!-- Nhóm select 2 cột -->
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="category" class="form-label">Danh mục</label>
                    <select
                      id="category"
                      [(ngModel)]="updatedProduct.category_id"
                      name="category"
                      class="form-control"
                      required
                    >
                      <option *ngFor="let category of categories" [value]="category.id">
                        {{ category.name }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group">
                    <label for="brand" class="form-label">Thương hiệu</label>
                    <select
                      id="brand"
                      [(ngModel)]="updatedProduct.brand_id"
                      name="brand"
                      class="form-control"
                      required
                    >
                      <option *ngFor="let brand of brands" [value]="brand.id">
                        {{ brand.name }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group">
                    <label for="material" class="form-label">Chất liệu</label>
                    <select
                      id="material"
                      [(ngModel)]="updatedProduct.material_id"
                      name="material"
                      class="form-control"
                      required
                    >
                      <option *ngFor="let material of materials" [value]="material.id">
                        {{ material.name }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group">
                    <label for="style" class="form-label">Phong cách</label>
                    <select
                      id="style"
                      [(ngModel)]="updatedProduct.style_id"
                      name="style"
                      class="form-control"
                      required
                    >
                      <option *ngFor="let style of styles" [value]="style.id">
                        {{ style.name }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group">
                    <label for="orgin" class="form-label">Xuất xứ</label>
                    <select
                      id="orgin"
                      [(ngModel)]="updatedProduct.origin_id"
                      name="orgin"
                      class="form-control"
                      required
                    >
                      <option *ngFor="let orgin of origins" [value]="orgin.id">
                        {{ orgin.name }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Thumbnails -->
              <div class="mb-3">
                <label class="form-label">Hình ảnh hiện có</label>
                <div class="thumbnail-container">
                  <div
                    *ngFor="let productImage of product?.product_images; let i = index"
                    class="thumbnail-item"
                    [ngClass]="{ 'active': i === currentImageIndex }"
                    (click)="thumbnailClick(i)"
                  >
                    <img [src]="productImage.image_url" class="thumbnail-image" alt="Thumbnail Image" />
                    <button
                      type="button"
                      class="btn btn-sm remove-image"
                      (click)="deleteImage(productImage)"
                    >
                      <i class="fa fa-times"></i>
                    </button>
                  </div>
                </div>
              </div>

              <!-- Upload ảnh mới -->
              <div class="form-group mb-3">
                <label for="images" class="form-label">Thêm ảnh mới (tối đa 5 ảnh)</label>
                <input
                  type="file"
                  id="images"
                  name="images"
                  class="form-control"
                  multiple
                  (change)="onFileChange($event)"
                  accept="image/*"
                />
                <small class="text-muted">Chọn tối đa 5 ảnh. Định dạng: JPG/PNG/WebP…</small>
              </div>

              <div class="d-flex justify-content-end">
                <button type="submit" class="btn btn-primary">
                  <i class="fa-regular fa-floppy-disk me-1"></i> Cập nhật
                </button>
              </div>
            </form>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>
