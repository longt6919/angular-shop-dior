<div class="min-vh-100 d-flex flex-column">
  <app-header></app-header>

  <div class="flex-grow-1 d-flex flex-column">
    <div class="container py-5">
      <div class="row">
        <form>
          <div class="col-md-12">
            <div class="bg-white rounded-3 p-4 shadow-lg rounded-4">
              <div class="row">
                <!-- Danh sách yêu thích -->
                <div class="col-md-12">
                  <div class="d-flex align-items-center justify-content-between mb-3">
                    <h5 class="fw-bold mb-0">Danh sách sản phẩm yêu thích</h5>
                    <span class="badge bg-danger-subtle text-danger border border-danger rounded-pill px-3 py-2">
                      <i class="fa-regular fa-heart me-1"></i>
{{ favorites.length || 0 }} mục
                    </span>
                  </div>

                  <div class="table-responsive" style="max-height: 400px; min-height: 200px; overflow-y: auto;">
                    <table class="table table-striped border rounded-2 order-table mb-0">
                      <thead class="table-light">
                        <tr>
                          <th class="text-nowrap">ID</th>
                          <th class="text-nowrap">Ảnh</th>
                          <th class="text-nowrap">Tên</th>
                          <th class="text-nowrap text-end">Giá</th>
                          <th class="text-nowrap">Mô tả</th>
                          <th class="text-nowrap text-center">Thao tác</th>
                        </tr>
                      </thead>

                      <!-- Dùng favorites (đã map sẵn thumbnail -> url trong component) -->
                      <tbody *ngIf="favorites?.length; else emptyFavorites">
                        <tr *ngFor="let product of favorites">
                          <td class="text-muted fw-semibold">{{ product.id }}</td>

                          <td>
                            <img
                              [src]="product.url"
                              (click)="onProductClick(product.id)"
                              [alt]="product.name"
                              class="rounded"
                              width="56"
                              height="56"
                              style="object-fit: cover;"
                            />
                          </td>

                          <td class="fw-semibold text-truncate" style="max-width: 240px" [title]="product.name">
                            {{ product.name }}
                          </td>

                          <td class="text-end fw-semibold text-primary">
                            {{ product.price | currency : 'VND' : 'symbol' : '1.0-0' }}
                          </td>

                          <td class="text-truncate" style="max-width: 360px" [title]="product.description">
                            {{ product.description }}
                          </td>

                          <td class="text-center">
                            <button class="btn btn-outline-danger btn-sm"
                                    title="Bỏ khỏi yêu thích"
                                    (click)="removeFromFavorites(product.id)">
                              <i class="fa-solid fa-heart-crack me-1"></i> Bỏ yêu thích
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <!-- Empty state -->
                  <ng-template #emptyFavorites>
                    <div class="py-5 text-center text-muted">
                      <i class="fa-regular fa-heart mb-2" style="font-size:40px;"></i>
                      Chưa có sản phẩm yêu thích.
                    </div>
                  </ng-template>
                </div>
                <!-- /col -->
              </div>
              <!-- /row -->
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <app-footer></app-footer>
</div>

<style>
.badge.bg-danger-subtle { background: rgba(220,53,69,.08); }
.order-table th, .order-table td { vertical-align: middle; }
</style>
